<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:XCommander.ViewModels"
             mc:Ignorable="d" d:DesignWidth="420" d:DesignHeight="500"
             x:Class="XCommander.Views.Dialogs.DirectoryHotlistDialog"
             x:DataType="vm:DirectoryHotlistViewModel">

    <Grid RowDefinitions="Auto,*,Auto">
        <!-- Header -->
        <Border Grid.Row="0"
                Background="{DynamicResource SystemControlBackgroundChromeMediumLowBrush}"
                Padding="10,8">
            <Grid ColumnDefinitions="*,Auto,Auto,Auto,Auto,Auto">
                <TextBlock Grid.Column="0"
                           Text="Directory Hotlist"
                           FontWeight="SemiBold"
                           VerticalAlignment="Center"/>
                <Button Grid.Column="1"
                        Content="Add Current"
                        Command="{Binding AddCurrentCommand}"
                        Margin="6,0,0,0"
                        Padding="6,2"/>
                <Button Grid.Column="2"
                        Content="New Category"
                        Click="OnNewCategoryClick"
                        Margin="6,0,0,0"
                        Padding="6,2"/>
                <Button Grid.Column="3"
                        Content="Rename"
                        Click="OnRenameClick"
                        Margin="6,0,0,0"
                        Padding="6,2"/>
                <Button Grid.Column="4"
                        Content="Delete"
                        Click="OnDeleteClick"
                        Margin="6,0,0,0"
                        Padding="6,2"/>
                <Button Grid.Column="5"
                        Content="Refresh"
                        Command="{Binding RefreshCommand}"
                        Margin="6,0,0,0"
                        Padding="6,2"/>
            </Grid>
        </Border>

        <!-- Hotlist tree -->
        <TreeView Grid.Row="1"
                  ItemsSource="{Binding Nodes}"
                  SelectedItem="{Binding SelectedNode}"
                  Margin="8"
                  KeyDown="OnTreeKeyDown"
                  DoubleTapped="OnTreeDoubleTapped">
            <TreeView.ContextMenu>
                <ContextMenu>
                    <MenuItem Header="Add current directory" Command="{Binding AddCurrentCommand}"/>
                    <MenuItem Header="Add category..." Click="OnNewCategoryClick"/>
                    <MenuItem Header="Add separator" Click="OnAddSeparatorClick"/>
                    <Separator/>
                    <MenuItem Header="Rename..." Click="OnRenameClick"/>
                    <MenuItem Header="Delete..." Click="OnDeleteClick"/>
                    <MenuItem Header="Set shortcut..." Click="OnSetShortcutClick"/>
                </ContextMenu>
            </TreeView.ContextMenu>
            <TreeView.ItemTemplate>
                <TreeDataTemplate ItemsSource="{Binding Children}">
                    <StackPanel Orientation="Horizontal" Spacing="6">
                        <TextBlock Text="{Binding Icon}"
                                   FontSize="11"
                                   IsVisible="{Binding !IsSeparator}"/>
                        <TextBlock Text="{Binding Name}"
                                   IsVisible="{Binding !IsSeparator}"/>
                        <TextBlock Text="{Binding Shortcut, StringFormat='({0})'}"
                                   FontSize="10"
                                   Opacity="0.6"
                                   Margin="6,0,0,0"
                                   IsVisible="{Binding Shortcut, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>
                        <Separator Width="180"
                                   Margin="4,2,0,0"
                                   IsVisible="{Binding IsSeparator}"/>
                    </StackPanel>
                </TreeDataTemplate>
            </TreeView.ItemTemplate>
        </TreeView>

        <!-- Footer -->
        <Border Grid.Row="2"
                Background="{DynamicResource SystemControlBackgroundChromeMediumLowBrush}"
                Padding="10,8">
            <Grid ColumnDefinitions="*,Auto">
                <TextBlock Grid.Column="0"
                           Text="Enter to open. Single-key shortcuts supported."
                           FontSize="11"
                           Opacity="0.7"
                           VerticalAlignment="Center"/>
                <Button Grid.Column="1"
                        Content="Close"
                        Padding="10,2"
                        Click="OnCloseClick"/>
            </Grid>
        </Border>
    </Grid>
</UserControl>
