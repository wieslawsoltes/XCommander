<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:controls="using:XCommander.Controls"
             xmlns:vm="using:XCommander.ViewModels"
             mc:Ignorable="d" d:DesignWidth="420" d:DesignHeight="500"
             x:Class="XCommander.Views.Dialogs.DirectoryHotlistDialog"
             x:DataType="vm:DirectoryHotlistViewModel">

    <UserControl.Resources>
        <DataTemplate x:Key="HotlistNodeTemplate"
                      x:DataType="vm:HotlistNodeViewModel">
            <StackPanel Orientation="Horizontal" Spacing="6">
                <TextBlock Text="{Binding Icon}"
                           FontSize="11"
                           IsVisible="{Binding !IsSeparator}"/>
                <TextBlock Text="{Binding Name}"
                           IsVisible="{Binding !IsSeparator}"/>
                <TextBlock Text="{Binding Shortcut, StringFormat='({0})'}"
                           FontSize="10"
                           Opacity="0.6"
                           Margin="6,0,0,0"
                           IsVisible="{Binding Shortcut, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>
                <Separator Width="180"
                           Margin="4,2,0,0"
                           IsVisible="{Binding IsSeparator}"/>
            </StackPanel>
        </DataTemplate>
    </UserControl.Resources>

    <Grid RowDefinitions="Auto,*,Auto" Margin="10">
        <controls:TcBevelPanel Grid.Row="0" Padding="6,4">
            <Grid ColumnDefinitions="*,Auto,Auto,Auto,Auto,Auto">
                <TextBlock Grid.Column="0"
                           Text="Directory Hotlist"
                           FontWeight="SemiBold"
                           VerticalAlignment="Center"/>
                <Button Grid.Column="1"
                        Content="Add Current"
                        Command="{Binding AddCurrentCommand}"
                        Margin="6,0,0,0"
                        Padding="6,2"/>
                <Button Grid.Column="2"
                        Content="New Category"
                        Click="OnNewCategoryClick"
                        Margin="6,0,0,0"
                        Padding="6,2"/>
                <Button Grid.Column="3"
                        Content="Rename"
                        Click="OnRenameClick"
                        Margin="6,0,0,0"
                        Padding="6,2"/>
                <Button Grid.Column="4"
                        Content="Delete"
                        Click="OnDeleteClick"
                        Margin="6,0,0,0"
                        Padding="6,2"/>
                <Button Grid.Column="5"
                        Content="Refresh"
                        Command="{Binding RefreshCommand}"
                        Margin="6,0,0,0"
                        Padding="6,2"/>
            </Grid>
        </controls:TcBevelPanel>

        <!-- Hotlist tree -->
        <controls:TcInsetPanel Grid.Row="1" Padding="0" Margin="0,6,0,0">
            <DataGrid Margin="6"
                      ColumnDefinitionsSource="{Binding ColumnDefinitions}"
                      FilteringModel="{Binding FilteringModel}"
                      SortingModel="{Binding SortingModel}"
                      SearchModel="{Binding SearchModel}"
                      HierarchicalRowsEnabled="True"
                      HierarchicalModel="{Binding HierarchicalModel}"
                      SelectedItem="{Binding SelectedHierarchicalNode, Mode=TwoWay}"
                      SelectionMode="Single"
                      CanUserResizeColumns="True"
                      CanUserReorderColumns="False"
                      CanUserSortColumns="True"
                      HeadersVisibility="None"
                      GridLinesVisibility="None"
                      BorderThickness="0"
                      IsReadOnly="True"
                      KeyDown="OnTreeKeyDown"
                      DoubleTapped="OnTreeDoubleTapped">
                <DataGrid.ContextFlyout>
                    <MenuFlyout>
                        <MenuItem Header="Add current directory" Command="{Binding AddCurrentCommand}"/>
                        <MenuItem Header="Add category..." Click="OnNewCategoryClick"/>
                        <MenuItem Header="Add separator" Click="OnAddSeparatorClick"/>
                        <Separator/>
                        <MenuItem Header="Rename..." Click="OnRenameClick"/>
                        <MenuItem Header="Delete..." Click="OnDeleteClick"/>
                        <MenuItem Header="Set shortcut..." Click="OnSetShortcutClick"/>
                    </MenuFlyout>
                </DataGrid.ContextFlyout>
                <DataGrid.FastPathOptions>
                    <DataGridFastPathOptions UseAccessorsOnly="True"
                                             ThrowOnMissingAccessor="True" />
                </DataGrid.FastPathOptions>
            </DataGrid>
        </controls:TcInsetPanel>

        <!-- Footer -->
        <controls:TcBevelPanel Grid.Row="2" Padding="6,4" Margin="0,6,0,0">
            <Grid ColumnDefinitions="*,Auto">
                <TextBlock Grid.Column="0"
                           Text="Enter to open. Single-key shortcuts supported."
                           FontSize="11"
                           Foreground="{DynamicResource TcMutedTextBrush}"
                           VerticalAlignment="Center"/>
                <Button Grid.Column="1"
                        Content="Close"
                        Padding="8,2"
                        Click="OnCloseClick"/>
            </Grid>
        </controls:TcBevelPanel>
    </Grid>
</UserControl>
